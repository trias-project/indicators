<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Damiano Oldoni" />
<meta name="author" content="Toon Van Daele" />
<meta name="author" content="Tim Adriaens" />

<meta name="date" content="2023-11-16" />

<title>Detect appearing and reappearing species</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="static/css/trias.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">TrIAS indicators</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Checklist-based indicators
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_get_data_input_checklist_indicators.html">Preprocessing for checklist-based indicators</a>
    </li>
    <li>
      <a href="02_indicator_introductions_per_year.html">New species introductions</a>
    </li>
    <li>
      <a href="03_indicator_cumulative_number.html">Cumulative number of species</a>
    </li>
    <li>
      <a href="04_indicator_pathways.html">Introduction pathways</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Occurrence-based indicators
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="05_occurrence_indicators_preprocessing.html">Preprocessing for occurrence-based indicators</a>
    </li>
    <li>
      <a href="06_occurrence_indicators_appearing_taxa.html">Appearing-reappearing species</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Emerging status analysis</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="07_occurrence_indicators_modelling.html">Assessing emerging status of alien species</a>
        </li>
        <li>
          <a href="08_ranking_emerging_status.html">Ranking species by emerging status</a>
        </li>
        <li>
          <a href="12_taxonomic_distribution_emerging_species.html">Taxonomic distribution of emerging species</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Protected areas analysis</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="09_define_overlay_grid_belgium_with_protected_areas.html">Belgian protected areas and EEA grid of Belgium</a>
        </li>
        <li>
          <a href="10_species_observations_occupancy_in_protected_areas.html">Belgian protected areas: observations and occupancy</a>
        </li>
        <li>
          <a href="11_status_alien_species_in_protected_areas.html">Status of invasion of Belgian protected areas</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/trias-project/pipeline">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Detect appearing and reappearing
species</h1>
<h4 class="author">Damiano Oldoni</h4>
<h4 class="author">Toon Van Daele</h4>
<h4 class="author">Tim Adriaens</h4>
<h4 class="date">2023-11-16</h4>

</div>


<p>In this document we analyze the Belgian datacube to detect possible
(re)appearing taxa in the last year. Such detection is based on some
basic rules instead of using GAM (Generalized Additive Models) as the
number of GBIF observations decreases sensibly during the current year
as effect of a puslishing delay. We also take into account the
appearing/reappearing in protected areas as additional warning.</p>
<div id="setup" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Setup</h1>
<p>Load libraries:</p>
<pre class="r"><code>library(tidyverse) # To do data science
library(tidylog) # To provide feedback on dplyr functions
library(here) # To find files
library(rgbif) # To get information from GBIF</code></pre>
</div>
<div id="get-data" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Get data</h1>
<p>We read the output of preprocessing pipeline.</p>
<p>Time series:</p>
<pre class="r"><code>df_ts &lt;- read_tsv(
  here::here(&quot;data&quot;, &quot;interim&quot;, &quot;df_timeseries.tsv&quot;),
  na = &quot;&quot;
)</code></pre>
<p>Columns <code>pa_obs</code> and <code>pa_native_obs</code> indicate
the presence (1) or absence (0) of the specific taxon and native species
at class level.</p>
<p>Preview:</p>
<pre class="r"><code># Get a taxon
taxon &lt;-
  df_ts$taxonKey[10]

# Preview
df_ts %&gt;%
  tidylog::filter(
    taxonKey == taxon,
    year %in% c(2016, 2017),
    eea_cell_code == &quot;1kmE3924N3102&quot;
  )</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["taxonKey"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["year"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["eea_cell_code"],"name":[3],"type":["chr"],"align":["left"]},{"label":["obs"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pa_obs"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["cobs"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["pa_cobs"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["classKey"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["natura2000"],"name":[9],"type":["lgl"],"align":["right"]}],"data":[],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Taxonomic information:</p>
<pre class="r"><code>spec_names &lt;- read_tsv(
  file = here::here(
    &quot;data&quot;,
    &quot;interim&quot;,
    &quot;timeseries_taxonomic_info.tsv&quot;
  )
)</code></pre>
</div>
<div id="detect-appearing---reappearing-species" class="section level1"
number="3">
<h1><span class="header-section-number">3</span> Detect appearing -
reappearing species</h1>
<p>Years to evaluate:</p>
<pre class="r"><code>present_year &lt;- lubridate::year(Sys.Date())
years &lt;- c(present_year) - 1 # The last full year
years</code></pre>
<pre><code>## [1] 2022</code></pre>
<p>We define the minimum latency (in years) before we speak about
reappearance. For example, a latency time window of 3 years means that
we consider a taxon reappearing in 2019 if observations occur in 2019
and 2015 or before:</p>
<pre class="r"><code>years_latency &lt;- 3</code></pre>
<div id="appearing---reappearing-species-in-belgium"
class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Appearing -
reappearing species in Belgium</h2>
<p>Lump geographic information:</p>
<pre class="r"><code>df_ts_compact &lt;-
  df_ts %&gt;%
  tidylog::group_by(taxonKey, year, classKey) %&gt;%
  tidylog::summarise(
    obs = sum(obs),
    cobs = sum(cobs),
    ncells = sum(pa_obs),
    c_ncells = sum(pa_cobs)
  ) %&gt;%
  tidylog::ungroup()</code></pre>
<p>We define the function <code>is_appearing</code> for
appearing/reappearing detection (this function could be moved to TrIAS
package <code>trias</code> later):</p>
<pre class="r fold-hide"><code>#&#39; @param df data frame with time series
#&#39; @param eval_years vector with years used for evaluation. Warning is returned
#&#39; if not a sequence. Typically present year and year before.
#&#39; @param latency years of latency (no observations). Strictly positive integer.
#&#39; @param df_reference data frame with time series used to assess reappearing. If NULL (default) df is used.
#&#39; @return data.frame with appearing or reappearing taxa
is_appearing &lt;- function(df,
                         eval_years,
                         latency = 2,
                         df_reference = NULL,
                         data_col = &quot;ncells&quot;,
                         id_col = &quot;taxonKey&quot;,
                         year_col = &quot;year&quot;) {
  df &lt;-
    df %&gt;%
    tidylog::select(id_col, year_col, data_col) %&gt;%
    tidylog::rename(
      &quot;taxonKey&quot; = id_col,
      &quot;year&quot; = year_col,
      &quot;occ&quot; = data_col
    ) %&gt;%
    tidylog::filter(occ &gt; 0) %&gt;%
    tidylog::group_by(taxonKey)

  if (!is.null(df_reference)) {
    df_reference &lt;-
      df_reference %&gt;%
      tidylog::select(id_col, year_col, data_col) %&gt;%
      tidylog::rename(
        &quot;taxonKey&quot; = id_col,
        &quot;year&quot; = year_col,
        &quot;occ&quot; = data_col
      ) %&gt;%
      tidylog::filter(occ &gt; 0) %&gt;%
      tidylog::group_by(taxonKey)
  } else {
    df_reference &lt;- df
  }

  # Taxa present in evaluated years

  taxa_eval_years_df &lt;-
    df %&gt;%
    tidylog::filter(year %in% eval_years) %&gt;%
    tidylog::filter(year == min(year))

  taxa_eval_years &lt;-
    taxa_eval_years_df %&gt;%
    tidylog::distinct(taxonKey) %&gt;%
    dplyr::pull()

  # appearing taxa
  appearing_taxa &lt;-
    df %&gt;%
    tidylog::filter(taxonKey %in% taxa_eval_years) %&gt;%
    tidylog::filter(min(year) %in% eval_years) %&gt;%
    tidylog::filter(year == min(year)) %&gt;%
    tidylog::ungroup()

  appearing_taxa &lt;-
    appearing_taxa %&gt;%
    tidylog::rename(!!sym(data_col) := &quot;occ&quot;)

  # reappearing taxa
  reappearing_taxa &lt;-
    df_reference %&gt;%
    tidylog::filter(taxonKey %in% taxa_eval_years) %&gt;%
    tidylog::filter(year &lt; min(eval_years)) %&gt;%
    tidylog::filter(year == max(year)) %&gt;%
    tidylog::ungroup() %&gt;%
    tidylog::rename(last_year_before_reappearing = year) %&gt;%
    tidylog::left_join(taxa_eval_years_df, by = &quot;taxonKey&quot;) %&gt;%
    tidylog::group_by(taxonKey) %&gt;%
    tidylog::summarise(n_latent_years = year - last_year_before_reappearing) %&gt;%
    tidylog::filter(n_latent_years &gt; latency) %&gt;%
    tidylog::left_join(taxa_eval_years_df %&gt;% tidylog::select(taxonKey, occ, year),
      by = &quot;taxonKey&quot;
    )

  reappearing_taxa &lt;-
    reappearing_taxa %&gt;%
    tidylog::rename(!!sym(data_col) := &quot;occ&quot;)

  return(list(
    appearing_taxa = appearing_taxa,
    reappearing_taxa = reappearing_taxa
  ))
}</code></pre>
<p>Apply function defined above:</p>
<pre class="r"><code>appearing_reappearing_taxa &lt;- is_appearing(
  df = df_ts_compact,
  eval_years = years,
  latency = years_latency,
  df_reference = NULL
)</code></pre>
<p>Number of appearing taxa:</p>
<pre class="r"><code>nrow(appearing_reappearing_taxa$appearing_taxa)</code></pre>
<pre><code>## [1] 9</code></pre>
<p>Number of reappearing taxa:</p>
<pre class="r"><code>nrow(appearing_reappearing_taxa$reappearing_taxa)</code></pre>
<pre><code>## [1] 59</code></pre>
</div>
<div id="appearing---reappearing-species-in-belgian-protected-areas"
class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Appearing -
reappearing species in Belgian protected areas</h2>
<p>We repeat the workflow defined above to assess which taxa are
appearing or reappearing in protected areas.</p>
<p>First we select( data referring to protected areas (Natura2000) and
then we lump geographical information:</p>
<pre class="r"><code>df_ts_compact_prot_areas &lt;-
  df_ts %&gt;%
  tidylog::filter(natura2000 == TRUE) %&gt;%
  tidylog::group_by(taxonKey, year) %&gt;%
  tidylog::summarise(
    obs = sum(obs),
    cobs = sum(cobs),
    ncells = sum(pa_cobs),
    c_ncells = sum(pa_cobs)
  ) %&gt;%
  tidylog::ungroup()</code></pre>
<p>We apply function <code>is_appearing</code>. Notice that we use
occurrences about all Belgium to assess the reappearance in protected
areas:</p>
<pre class="r"><code>appearing_reappearing_taxa_prot_areas &lt;- is_appearing(
  df = df_ts_compact_prot_areas,
  eval_years = years,
  latency = years_latency,
  df_reference = df_ts_compact
)</code></pre>
<p>Number of appearing taxa:</p>
<pre class="r"><code>nrow(appearing_reappearing_taxa_prot_areas$appearing_taxa)</code></pre>
<pre><code>## [1] 31</code></pre>
<p>Number of reappearing taxa:</p>
<pre class="r"><code>nrow(appearing_reappearing_taxa_prot_areas$reappearing_taxa)</code></pre>
<pre><code>## [1] 35</code></pre>
</div>
<div id="merge" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Merge</h2>
<p>We merge appearing taxa from all Belgium and from protected areas. We
rank taxa by area of occupancy (number of cells) in protected areas and
in all Belgium. We do the same for reappearing taxa as well:</p>
<pre class="r"><code>app_reapp_global &lt;-
  purrr::map2(
    appearing_reappearing_taxa_prot_areas,
    appearing_reappearing_taxa,
    function(x, y) {
      x &lt;-
        x %&gt;%
        tidylog::rename(ncells_prot_areas = ncells)
      y &lt;-
        y %&gt;%
        tidylog::rename(ncells_BE = ncells)
      tidylog::full_join(x, y) %&gt;%
        tidylog::mutate(
          in_prot_areas = ifelse(!is.na(ncells_prot_areas),
            TRUE,
            FALSE
          ),
          in_BE = ifelse(!is.na(ncells_BE),
            TRUE,
            FALSE
          )
        ) %&gt;%
        arrange(
          desc(ncells_prot_areas),
          desc(ncells_BE)
        )
    }
  )</code></pre>
</div>
<div id="add-canonical-names" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Add canonical
names</h2>
<p>Add taxonomic information for better readibility.</p>
<pre class="r"><code>app_reapp_global &lt;- purrr::map(
  app_reapp_global,
  function(x) {
    x %&gt;%
      tidylog::left_join(spec_names, by = &quot;taxonKey&quot;)
  }
)</code></pre>
</div>
</div>
<div id="table-of-appearing-and-reappearing-taxa" class="section level1"
number="4">
<h1><span class="header-section-number">4</span> Table of appearing and
reappearing taxa</h1>
<div id="appearing-taxa" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Appearing taxa</h2>
<p>Reorder columns of data.frame containing appearring taxa:</p>
<pre class="r"><code>app_reapp_global$appearing_taxa &lt;-
  app_reapp_global$appearing_taxa %&gt;%
  tidylog::select(
    taxonKey,
    canonicalName,
    year,
    ncells_prot_areas,
    ncells_BE,
    in_prot_areas,
    in_BE,
    class,
    kingdom,
    classKey,
    kingdomKey
  )</code></pre>
<p>Appearing taxa:</p>
<pre class="r"><code>app_reapp_global$appearing_taxa</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["taxonKey"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["canonicalName"],"name":[2],"type":["chr"],"align":["left"]},{"label":["year"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["ncells_prot_areas"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["ncells_BE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["in_prot_areas"],"name":[6],"type":["lgl"],"align":["right"]},{"label":["in_BE"],"name":[7],"type":["lgl"],"align":["right"]},{"label":["class"],"name":[8],"type":["chr"],"align":["left"]},{"label":["kingdom"],"name":[9],"type":["chr"],"align":["left"]},{"label":["classKey"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["kingdomKey"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"2684120","2":"Sequoiadendron giganteum","3":"2022","4":"5","5":"NA","6":"TRUE","7":"FALSE","8":"Pinopsida","9":"Plantae","10":"194","11":"6"},{"1":"5359109","2":"Trifolium squarrosum","3":"2022","4":"2","5":"2","6":"TRUE","7":"TRUE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"3054366","2":"Juglans ailantifolia","3":"2022","4":"2","5":"NA","6":"TRUE","7":"FALSE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"3119206","2":"Helianthus maximiliani","3":"2022","4":"2","5":"NA","6":"TRUE","7":"FALSE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"3172206","2":"Veronicastrum virginicum","3":"2022","4":"2","5":"NA","6":"TRUE","7":"FALSE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"3586046","2":"Gladiolus hortulanus","3":"2022","4":"2","5":"NA","6":"TRUE","7":"FALSE","8":"Liliopsida","9":"Plantae","10":"196","11":"6"},{"1":"4033335","2":"Bistorta affinis","3":"2022","4":"2","5":"NA","6":"TRUE","7":"FALSE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"5370829","2":"Acaena caesiiglauca","3":"2022","4":"2","5":"NA","6":"TRUE","7":"FALSE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"8059430","2":"Heleobia charruana","3":"2022","4":"2","5":"NA","6":"TRUE","7":"FALSE","8":"Gastropoda","9":"Animalia","10":"225","11":"1"},{"1":"7497356","2":"Tagetes tenuifolia","3":"2022","4":"1","5":"2","6":"TRUE","7":"TRUE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"1683815","2":"Rhacocleis annulata","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"Insecta","9":"Animalia","10":"216","11":"1"},{"1":"2479308","2":"Platycercus adscitus","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"Aves","9":"Animalia","10":"212","11":"1"},{"1":"2495691","2":"Streptopelia tranquebarica","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"Aves","9":"Animalia","10":"212","11":"1"},{"1":"1411953","2":"Carausius morosus","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Insecta","9":"Animalia","10":"216","11":"1"},{"1":"1910629","2":"Hypolimnas bolina","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Insecta","9":"Animalia","10":"216","11":"1"},{"1":"2176858","2":"Philaeus chrysops","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Arachnida","9":"Animalia","10":"367","11":"1"},{"1":"2431781","2":"Salamandra atra","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Amphibia","9":"Animalia","10":"131","11":"1"},{"1":"2440196","2":"Macropus rufogriseus","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Mammalia","9":"Animalia","10":"359","11":"1"},{"1":"2481915","2":"Ciconia abdimii","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Aves","9":"Animalia","10":"212","11":"1"},{"1":"2489005","2":"Acridotheres tristis","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Aves","9":"Animalia","10":"212","11":"1"},{"1":"2855823","2":"Allium nigrum","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Liliopsida","9":"Plantae","10":"196","11":"6"},{"1":"2879411","2":"Quercus suber","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"2971024","2":"Melilotus officinalis (L.) Pallas","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"3048397","2":"Erysimum bicolor","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"5217334","2":"Xenopus laevis","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Amphibia","9":"Animalia","10":"131","11":"1"},{"1":"5229044","2":"Psittacula cyanocephala","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Aves","9":"Animalia","10":"212","11":"1"},{"1":"5285635","2":"Pinus rigida","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Pinopsida","9":"Plantae","10":"194","11":"6"},{"1":"7100404","2":"Acer buergerianum","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"7420038","2":"Prunella grandiflora","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"7753992","2":"Helix lucorum","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Gastropoda","9":"Animalia","10":"225","11":"1"},{"1":"10852031","2":"Oncosiphon pilulifer","3":"2022","4":"1","5":"NA","6":"TRUE","7":"FALSE","8":"Magnoliopsida","9":"Plantae","10":"220","11":"6"},{"1":"5208832","2":"Gobiosoma bosc","3":"2022","4":"NA","5":"3","6":"FALSE","7":"TRUE","8":"NA","9":"Animalia","10":"NA","11":"1"},{"1":"2285504","2":"Yoldia limatula","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"Bivalvia","9":"Animalia","10":"137","11":"1"},{"1":"4486432","2":"Dieuches armatipes","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"Insecta","9":"Animalia","10":"216","11":"1"},{"1":"5166760","2":"Ammothea hilgendorfi","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"Pycnogonida","9":"Animalia","10":"354","11":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Empty <code>ncells_BE</code> and <code>in_BE</code> equal to FALSE
means that the taxon is appearing in protected areas but not appearing
outside, i.e.Â the taxon is maybe reappearing at Belgian level or
occurring with a more stable presence. See next section for more details
about.</p>
</div>
<div id="reappearing-taxa" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Reappearing taxa</h2>
<p>Reorder columns of data.frame containing reappearing taxa:</p>
<pre class="r"><code>app_reapp_global$reappearing_taxa &lt;-
  app_reapp_global$reappearing_taxa %&gt;%
  tidylog::select(
    taxonKey,
    canonicalName,
    year,
    ncells_prot_areas,
    ncells_BE,
    in_prot_areas,
    in_BE,
    n_latent_years,
    class,
    kingdom,
    classKey,
    kingdomKey
  )</code></pre>
<p>Reappearing taxa:</p>
<pre class="r"><code>app_reapp_global$reappearing_taxa</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["taxonKey"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["canonicalName"],"name":[2],"type":["chr"],"align":["left"]},{"label":["year"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["ncells_prot_areas"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["ncells_BE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["in_prot_areas"],"name":[6],"type":["lgl"],"align":["right"]},{"label":["in_BE"],"name":[7],"type":["lgl"],"align":["right"]},{"label":["n_latent_years"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["class"],"name":[9],"type":["chr"],"align":["left"]},{"label":["kingdom"],"name":[10],"type":["chr"],"align":["left"]},{"label":["classKey"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["kingdomKey"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"2492196","2":"Melospiza melodia","3":"2022","4":"21","5":"41","6":"TRUE","7":"TRUE","8":"18","9":"Aves","10":"Animalia","11":"212","12":"1"},{"1":"5406735","2":"Sida rhombifolia","3":"2022","4":"13","5":"32","6":"TRUE","7":"TRUE","8":"5","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"2928666","2":"Dichondra micrantha","3":"2022","4":"5","5":"5","6":"TRUE","7":"TRUE","8":"5","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"1885213","2":"Crocidophora butleri","3":"2022","4":"4","5":"7","6":"TRUE","7":"TRUE","8":"4","9":"Insecta","10":"Animalia","11":"216","12":"1"},{"1":"5660450","2":"Pulmonaria rubra","3":"2022","4":"4","5":"7","6":"TRUE","7":"TRUE","8":"6","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"2889010","2":"Rumex cristatus","3":"2022","4":"4","5":"5","6":"TRUE","7":"TRUE","8":"10","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"5360429","2":"Trigonella caelesyriaca","3":"2022","4":"4","5":"5","6":"TRUE","7":"TRUE","8":"11","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"7881150","2":"Polygonatum hybridum","3":"2022","4":"2","5":"6","6":"TRUE","7":"TRUE","8":"6","9":"Liliopsida","10":"Plantae","11":"196","12":"6"},{"1":"5341394","2":"Perilla frutescens","3":"2022","4":"2","5":"5","6":"TRUE","7":"TRUE","8":"5","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"2970585","2":"Sesbania herbacea","3":"2022","4":"2","5":"4","6":"TRUE","7":"TRUE","8":"5","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"7116158","2":"Sphaeralcea bonariensis","3":"2022","4":"2","5":"3","6":"TRUE","7":"TRUE","8":"6","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3586046","2":"Gladiolus hortulanus","3":"2022","4":"2","5":"2","6":"TRUE","7":"TRUE","8":"5","9":"Liliopsida","10":"Plantae","11":"196","12":"6"},{"1":"5217334","2":"Xenopus laevis","3":"2022","4":"1","5":"7","6":"TRUE","7":"TRUE","8":"6","9":"Amphibia","10":"Animalia","11":"131","12":"1"},{"1":"6100962","2":"Urocissa erythroryncha","3":"2022","4":"1","5":"4","6":"TRUE","7":"TRUE","8":"4","9":"Aves","10":"Animalia","11":"212","12":"1"},{"1":"3066993","2":"Euphorbia dentata","3":"2022","4":"1","5":"3","6":"TRUE","7":"TRUE","8":"18","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3100375","2":"Acanthospermum hispidum","3":"2022","4":"1","5":"3","6":"TRUE","7":"TRUE","8":"17","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3596131","2":"Halimium lasianthum alyssoides","3":"2022","4":"1","5":"3","6":"TRUE","7":"TRUE","8":"10","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"8237223","2":"Halimium lasianthum","3":"2022","4":"1","5":"3","6":"TRUE","7":"TRUE","8":"10","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3044912","2":"Alyssum montanum","3":"2022","4":"1","5":"2","6":"TRUE","7":"TRUE","8":"5","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3054352","2":"Juglans cinerea","3":"2022","4":"1","5":"2","6":"TRUE","7":"TRUE","8":"5","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3172294","2":"Ligustrum sinense","3":"2022","4":"1","5":"2","6":"TRUE","7":"TRUE","8":"5","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"4497180","2":"Andricus aries","3":"2022","4":"1","5":"2","6":"TRUE","7":"TRUE","8":"4","9":"Insecta","10":"Animalia","11":"216","12":"1"},{"1":"5219681","2":"Sciurus carolinensis","3":"2022","4":"1","5":"2","6":"TRUE","7":"TRUE","8":"4","9":"Mammalia","10":"Animalia","11":"359","12":"1"},{"1":"5569367","2":"Scaevola aemula","3":"2022","4":"1","5":"2","6":"TRUE","7":"TRUE","8":"8","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"1910629","2":"Hypolimnas bolina","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"4","9":"Insecta","10":"Animalia","11":"216","12":"1"},{"1":"2431781","2":"Salamandra atra","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"5","9":"Amphibia","10":"Animalia","11":"131","12":"1"},{"1":"2474162","2":"Coturnix japonica","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"10","9":"Aves","10":"Animalia","11":"212","12":"1"},{"1":"2701578","2":"Juncus foliosus","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"4","9":"Liliopsida","10":"Plantae","11":"196","12":"6"},{"1":"2765221","2":"Tradescantia pallida","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"5","9":"Liliopsida","10":"Plantae","11":"196","12":"6"},{"1":"2858501","2":"Narcissus triandrus","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"4","9":"Liliopsida","10":"Plantae","11":"196","12":"6"},{"1":"3104150","2":"Tripleurospermum decipiens","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"4","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3142967","2":"Doronicum orientale","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"4","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3631129","2":"Eryngium giganteum","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"17","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3693336","2":"Rorippa anceps","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"13","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"5332120","2":"Betula papyrifera","3":"2022","4":"1","5":"1","6":"TRUE","7":"TRUE","8":"13","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"2489004","2":"Acridotheres ginginianus","3":"2022","4":"NA","5":"2","6":"FALSE","7":"TRUE","8":"6","9":"Aves","10":"Animalia","11":"212","12":"1"},{"1":"2965434","2":"Medicago monspeliaca","3":"2022","4":"NA","5":"2","6":"FALSE","7":"TRUE","8":"6","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3088623","2":"Guizotia scabra","3":"2022","4":"NA","5":"2","6":"FALSE","7":"TRUE","8":"7","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3829143","2":"Erodium stephanianum","3":"2022","4":"NA","5":"2","6":"FALSE","7":"TRUE","8":"10","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"5300102","2":"Gagea pratensis","3":"2022","4":"NA","5":"2","6":"FALSE","7":"TRUE","8":"24","9":"Liliopsida","10":"Plantae","11":"196","12":"6"},{"1":"5855746","2":"Meretrix lyrata","3":"2022","4":"NA","5":"2","6":"FALSE","7":"TRUE","8":"4","9":"Bivalvia","10":"Animalia","11":"137","12":"1"},{"1":"7901010","2":"Rumex obtusifolius sylvestris","3":"2022","4":"NA","5":"2","6":"FALSE","7":"TRUE","8":"8","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"2172885","2":"Evarcha jucunda","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"27","9":"Arachnida","10":"Animalia","11":"367","12":"1"},{"1":"2215949","2":"Melita nitida","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"6","9":"Malacostraca","10":"Animalia","11":"229","12":"1"},{"1":"2379105","2":"Neogobius fluviatilis","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"10","9":"NA","10":"Animalia","11":"NA","12":"1"},{"1":"2498288","2":"Coscoroba coscoroba","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"13","9":"Aves","10":"Animalia","11":"212","12":"1"},{"1":"2874190","2":"Passiflora edulis","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"8","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"2925530","2":"Verbena urticifolia","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"17","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"2996897","2":"Rubus setchuenensis","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"11","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3112994","2":"Cirsium subalpinum","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"36","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"3916499","2":"Caylusea abyssinica","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"7","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"4496869","2":"Neuroterus saliens","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"6","9":"Insecta","10":"Animalia","11":"216","12":"1"},{"1":"5392270","2":"Cichorium pumilum","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"49","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"5415056","2":"Forsythia suspensa","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"9","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"5609719","2":"Scutellaria columnae","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"5","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"6068804","2":"Cenchrus petiolaris","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"22","9":"Liliopsida","10":"Plantae","11":"196","12":"6"},{"1":"6709291","2":"Reynoutria compacta","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"4","9":"Magnoliopsida","10":"Plantae","11":"220","12":"6"},{"1":"7529533","2":"Canna hybrida","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"5","9":"Liliopsida","10":"Plantae","11":"196","12":"6"},{"1":"9592414","2":"Sporobolus michauxianus","3":"2022","4":"NA","5":"1","6":"FALSE","7":"TRUE","8":"4","9":"Liliopsida","10":"Plantae","11":"196","12":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Taxa appearing in protected areas and reappearing outside:</p>
<pre class="r"><code>app_reapp_global$appearing_taxa %&gt;%
  tidylog::filter(in_BE == FALSE) %&gt;%
  tidylog::filter(taxonKey %in% app_reapp_global$reappearing_taxa$taxonKey) %&gt;%
  tidylog::select(taxonKey, canonicalName)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["taxonKey"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["canonicalName"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"3586046","2":"Gladiolus hortulanus"},{"1":"1910629","2":"Hypolimnas bolina"},{"1":"2431781","2":"Salamandra atra"},{"1":"5217334","2":"Xenopus laevis"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Taxa appearing in protected areas and with a stable presence
outside:</p>
<pre class="r"><code>app_reapp_global$appearing_taxa %&gt;%
  tidylog::filter(in_BE == FALSE) %&gt;%
  tidylog::filter(!taxonKey %in% app_reapp_global$reappearing_taxa$taxonKey) %&gt;%
  tidylog::select(taxonKey, canonicalName, class, kingdom, classKey, kingdomKey)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["taxonKey"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["canonicalName"],"name":[2],"type":["chr"],"align":["left"]},{"label":["class"],"name":[3],"type":["chr"],"align":["left"]},{"label":["kingdom"],"name":[4],"type":["chr"],"align":["left"]},{"label":["classKey"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["kingdomKey"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"2684120","2":"Sequoiadendron giganteum","3":"Pinopsida","4":"Plantae","5":"194","6":"6"},{"1":"3054366","2":"Juglans ailantifolia","3":"Magnoliopsida","4":"Plantae","5":"220","6":"6"},{"1":"3119206","2":"Helianthus maximiliani","3":"Magnoliopsida","4":"Plantae","5":"220","6":"6"},{"1":"3172206","2":"Veronicastrum virginicum","3":"Magnoliopsida","4":"Plantae","5":"220","6":"6"},{"1":"4033335","2":"Bistorta affinis","3":"Magnoliopsida","4":"Plantae","5":"220","6":"6"},{"1":"5370829","2":"Acaena caesiiglauca","3":"Magnoliopsida","4":"Plantae","5":"220","6":"6"},{"1":"8059430","2":"Heleobia charruana","3":"Gastropoda","4":"Animalia","5":"225","6":"1"},{"1":"1411953","2":"Carausius morosus","3":"Insecta","4":"Animalia","5":"216","6":"1"},{"1":"2176858","2":"Philaeus chrysops","3":"Arachnida","4":"Animalia","5":"367","6":"1"},{"1":"2440196","2":"Macropus rufogriseus","3":"Mammalia","4":"Animalia","5":"359","6":"1"},{"1":"2481915","2":"Ciconia abdimii","3":"Aves","4":"Animalia","5":"212","6":"1"},{"1":"2489005","2":"Acridotheres tristis","3":"Aves","4":"Animalia","5":"212","6":"1"},{"1":"2855823","2":"Allium nigrum","3":"Liliopsida","4":"Plantae","5":"196","6":"6"},{"1":"2879411","2":"Quercus suber","3":"Magnoliopsida","4":"Plantae","5":"220","6":"6"},{"1":"2971024","2":"Melilotus officinalis (L.) Pallas","3":"Magnoliopsida","4":"Plantae","5":"220","6":"6"},{"1":"3048397","2":"Erysimum bicolor","3":"Magnoliopsida","4":"Plantae","5":"220","6":"6"},{"1":"5229044","2":"Psittacula cyanocephala","3":"Aves","4":"Animalia","5":"212","6":"1"},{"1":"5285635","2":"Pinus rigida","3":"Pinopsida","4":"Plantae","5":"194","6":"6"},{"1":"7100404","2":"Acer buergerianum","3":"Magnoliopsida","4":"Plantae","5":"220","6":"6"},{"1":"7420038","2":"Prunella grandiflora","3":"Magnoliopsida","4":"Plantae","5":"220","6":"6"},{"1":"7753992","2":"Helix lucorum","3":"Gastropoda","4":"Animalia","5":"225","6":"1"},{"1":"10852031","2":"Oncosiphon pilulifer","3":"Magnoliopsida","4":"Plantae","5":"220","6":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Two examples:</p>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["taxonKey"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["canonicalName"],"name":[2],"type":["chr"],"align":["left"]},{"label":["year"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["classKey"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["obs"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["cobs.x"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["ncells"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["c_ncells.x"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["prot_areas_obs"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["cobs.y"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["prot_areas_ncells"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["c_ncells.y"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"2684120","2":"Sequoiadendron giganteum","3":"2018","4":"194","5":"2","6":"0","7":"2","8":"0","9":"1","10":"0","11":"0","12":"0"},{"1":"2684120","2":"Sequoiadendron giganteum","3":"2019","4":"194","5":"1","6":"0","7":"1","8":"0","9":"0","10":"0","11":"0","12":"0"},{"1":"2684120","2":"Sequoiadendron giganteum","3":"2020","4":"194","5":"6","6":"0","7":"6","8":"0","9":"4","10":"0","11":"0","12":"0"},{"1":"2684120","2":"Sequoiadendron giganteum","3":"2021","4":"194","5":"9","6":"26","7":"9","8":"1","9":"3","10":"0","11":"0","12":"0"},{"1":"2684120","2":"Sequoiadendron giganteum","3":"2022","4":"194","5":"13","6":"7","7":"12","8":"7","9":"7","10":"5","11":"5","12":"5"},{"1":"2684120","2":"Sequoiadendron giganteum","3":"2023","4":"194","5":"8","6":"35","7":"8","8":"5","9":"5","10":"22","11":"4","12":"4"},{"1":"3054366","2":"Juglans ailantifolia","3":"2021","4":"220","5":"1","6":"21","7":"1","8":"1","9":"0","10":"0","11":"0","12":"0"},{"1":"3054366","2":"Juglans ailantifolia","3":"2022","4":"220","5":"3","6":"151","7":"2","8":"2","9":"3","10":"151","11":"2","12":"2"},{"1":"3054366","2":"Juglans ailantifolia","3":"2023","4":"220","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="save-data" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Save data</h1>
<div id="appearing-taxa-1" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Appearing taxa</h2>
<p>Save appearing taxa:</p>
<pre class="r"><code>write_tsv(app_reapp_global$appearing_taxa,
  file = here::here(&quot;data&quot;, &quot;output&quot;, &quot;appearing_taxa.tsv&quot;),
  na = &quot;&quot;
)</code></pre>
</div>
<div id="reappearing-taxa-1" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Reappearing taxa</h2>
<p>Save reappearing taxa:</p>
<pre class="r"><code>write_tsv(app_reapp_global$reappearing_taxa,
  file = here::here(&quot;data&quot;, &quot;output&quot;, &quot;reappearing_taxa.tsv&quot;),
  na = &quot;&quot;
)</code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
