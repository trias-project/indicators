---
title: "Status of alien species in Belgian protected areas"
author: 
  - Damiano Oldoni
  - Tim Adriaens
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(echo = TRUE)
```

# Goal

In this document we analyze the status of alien species in the Belgian protected areas.

# Setup 

```{r load_libraries, message=FALSE, warning=FALSE}
library(tidyverse)  # To do datascience
library(lubridate)  # To work with dates
library(tidylog)  # To provide feedback on dplyr functions
library(here) # To find files
library(purrr) # To do loops
```

# Read input data

Read data related to species distribution in protected areas:

```{r read_occs_prot_areas}
occs_prot_areas <-
  read_csv(here::here(
    "data",
    "output",
    "occurrences_occupancy_protected_areas.csv"
  ), na = ""
)
```

Related taxonomic metadata:

```{r read_taxonomic_metadata}
taxonomic_metadata <-
  read_csv(here::here(
    "data",
    "output",
    "protected_areas_species_info.csv"
  ),
  na = ""
)
```

and protected areas metadata:

```{r read_protected_areas_metadata}
protected_areas_metadata <-
  read_csv(
    here::here(
      "data",
      "output",
      "protected_areas_metadata.csv"
    ),
    na = ""
)
```

Read the list of invasive alien species of Union concern:

```{r eu_list}
eu_concern_species <- 
  read_tsv(
    here::here(
      "data",
      "input",
      "eu_concern_species.tsv"
    ),
  na = ""
)
```

# State of invasion of protected areas

We analyze the state of invasion of protected areas based on observations from 2000.

```{r begin_year}
begin_year <- 2000
```

## Natura2000 areas

We start by taking into account all type of areas.

### Belgium

Number of alien taxa and total number of observations of alien taxa in each protected area from 2000 up to now:

```{r n_taxa_obs_per_area}
n_taxa_obs_per_area <-
  occs_prot_areas %>%
    left_join(protected_areas_metadata %>% 
                select(-SITETYPE),
              by = "SITECODE") %>%
  filter(is_alien == TRUE) %>%
  filter(year >= begin_year) %>%
  group_by(SITECODE,
           SITENAME,
           SITETYPE,
           flanders,
           wallonia,
           brussels) %>%
  summarize(n_taxa =  length(unique(speciesKey)),
            n_obs = n()) %>%
  ungroup() %>%
  arrange(desc(n_taxa), desc(n_obs)) %>%
  select(SITECODE,
         SITENAME,
         SITETYPE,
         n_taxa,
         n_obs,
         everything())
n_taxa_obs_per_area
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_taxa_obs_per_area_concern}
n_taxa_obs_per_area_concern <-
  occs_prot_areas %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey) %>%
    left_join(protected_areas_metadata,
              by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE) %>%
  filter(year >= begin_year) %>%
  group_by(SITECODE,
           SITENAME,
           SITETYPE,
           flanders,
           wallonia,
           brussels) %>%
  summarize(n_taxa =  length(unique(speciesKey)),
            n_obs = n()) %>%
  ungroup() %>%
  arrange(desc(n_taxa), desc(n_obs)) %>%
  select(SITECODE,
         SITENAME,
         SITETYPE,
         n_taxa,
         n_obs,
         everything())
n_taxa_obs_per_area_concern
```

### Flanders

Number of alien taxa and number of observations of alien taxa in each Flemish protected area from 2000 up to now:

```{r n_taxa_obs_per_area_flanders}
n_taxa_obs_per_area_flanders <- 
  n_taxa_obs_per_area %>%
  filter(flanders == TRUE)
n_taxa_obs_per_area_flanders
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_taxa_obs_per_area_concern_flanders}
n_taxa_obs_per_area_concern_flanders <-
  n_taxa_obs_per_area_concern %>%
  filter(flanders == TRUE)
n_taxa_obs_per_area_concern_flanders
```

### Wallonia

Number of alien taxa and number of observations of alien taxa in each protected area of Wallonia from 2000 up to now:

```{r n_taxa_obs_per_area_wallonia}
n_taxa_obs_per_area_wallonia <-
  n_taxa_obs_per_area %>%
  filter(wallonia == TRUE)
n_taxa_obs_per_area_wallonia
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_taxa_obs_per_area_concern_wallonia}
n_taxa_obs_per_area_concern_wallonia <- 
  n_taxa_obs_per_area_concern %>%
  filter(wallonia == TRUE)
n_taxa_obs_per_area_concern_wallonia
```
### Brussels

Number of alien taxa and number of observations of alien taxa in each protected area of Brussels from 2000 up to now:

```{r n_taxa_obs_per_area_brussels}
n_taxa_obs_per_area_brussels <-
  n_taxa_obs_per_area %>%
  filter(brussels == TRUE)
n_taxa_obs_per_area_brussels
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_taxa_obs_per_area_concern_brussels}
n_taxa_obs_per_area_concern_brussels <- 
  n_taxa_obs_per_area_concern %>%
  filter(brussels == TRUE)
n_taxa_obs_per_area_concern_brussels
```

## Bird directive areas

We show the results for the bird directive areas (SPA areas), i.e. areas of `SITETYPE` value `A` or `C`.

### Belgium

Number of alien taxa and number of observations of alien taxa in each SPA area from 2000 up to now:

```{r n_taxa_obs_per_area_bird}
n_taxa_obs_per_area_bird <-
  n_taxa_obs_per_area %>%
  filter(SITETYPE %in% c("A", "C"))
n_taxa_obs_per_area_bird
```

Limited to species from the list of Union concern:

```{r n_taxa_obs_per_area_concern_bird}
n_taxa_obs_per_area_concern_bird <-
  n_taxa_obs_per_area_concern %>%
  filter(SITETYPE %in% c("A", "C"))
n_taxa_obs_per_area_concern_bird
```

We repeat this analysis for each Belgian region separately.

### Flanders

Number of alien taxa and number of observations of alien taxa in each Flemish SPA area from 2000 up to now:

```{r n_taxa_obs_per_area_flanders_bird}
n_taxa_obs_per_area_flanders_bird <-
  n_taxa_obs_per_area_flanders %>%
  filter(SITETYPE %in% c("A","C"))
n_taxa_obs_per_area_flanders_bird
```

Limited to species from the list of Union concern:

```{r n_taxa_obs_per_area_concern_flanders_bird}
n_taxa_obs_per_area_concern_flanders_bird <-
  n_taxa_obs_per_area_concern_flanders %>%
  filter(SITETYPE %in% c("A","C"))
n_taxa_obs_per_area_concern_flanders_bird
```

### Wallonia

Number of alien taxa and number of observations of alien taxa in each SPA area of Wallonia from 2000 up to now:

```{r n_taxa_obs_per_area_wallonia_bird}
n_taxa_obs_per_area_wallonia_bird <-
  n_taxa_obs_per_area_wallonia %>%
  filter(SITETYPE %in% c("A","C"))
n_taxa_obs_per_area_wallonia_bird
```

Limited to species from the list of Union concern:

```{r n_taxa_obs_per_area_concern_wallonia_bird}
n_taxa_obs_per_area_concern_wallonia_bird <-
  n_taxa_obs_per_area_concern_wallonia %>%
  filter(SITETYPE %in% c("A","C"))
n_taxa_obs_per_area_concern_wallonia_bird
```

### Brussels

Number of alien taxa and number of observations of alien taxa in each SPA area of Brussels from 2000 up to now:

```{r n_taxa_obs_per_area_brussels_bird}
n_taxa_obs_per_area_brussels_bird <-
  n_taxa_obs_per_area_brussels %>%
  filter(SITETYPE %in% c("A","C"))
n_taxa_obs_per_area_brussels_bird
```

Limited to species from the list of Union concern:

```{r n_taxa_obs_per_area_concern_brussels_bird}
n_taxa_obs_per_area_concern_brussels_bird <-
  n_taxa_obs_per_area_concern_brussels %>%
  filter(SITETYPE %in% c("A","C"))
n_taxa_obs_per_area_concern_brussels_bird
```

## Habitat directive areas

We show the results for habitat directive areas (SAC areas), i.e. areas of `SITETYPE` value `B` or `C`.

### Belgium

Number of alien taxa and number of observations of alien taxa in each SAC area from 2000 up to now:

```{r n_taxa_obs_per_area_habitat}
n_taxa_obs_per_area_habitat <-
  n_taxa_obs_per_area %>%
  filter(SITETYPE %in% c("B", "C"))
n_taxa_obs_per_area_habitat
```

Limited to species from the list of Union concern:

```{r n_taxa_obs_per_area_concern_habitat}
n_taxa_obs_per_area_concern_habitat <-
  n_taxa_obs_per_area_concern %>%
  filter(SITETYPE %in% c("B","C"))
n_taxa_obs_per_area_concern_habitat
```
We repeat the same analysis for each of the three Belgian regions.

### Flanders

Number of alien taxa and number of observations of alien taxa in each Flemish SAC area from 2000 up to now:

```{r n_taxa_obs_per_area_flanders_habitat}
n_taxa_obs_per_area_flanders_habitat <-
  n_taxa_obs_per_area_flanders %>%
  filter(SITETYPE %in% c("B","C"))
n_taxa_obs_per_area_flanders_habitat
```

Limited to species from the list of Union concern:

```{r n_taxa_obs_per_area_concern_flanders_habitat}
n_taxa_obs_per_area_concern_flanders_habitat <-
  n_taxa_obs_per_area_concern_flanders %>%
  filter(SITETYPE %in% c("B","C"))
n_taxa_obs_per_area_concern_flanders_habitat
```

### Wallonia

Number of alien taxa and number of observations of alien taxa in each SAC area of Wallonia from 2000 up to now:

```{r n_taxa_obs_per_area_wallonia_habitat}
n_taxa_obs_per_area_wallonia_habitat <-
  n_taxa_obs_per_area_wallonia %>%
  filter(SITETYPE %in% c("B","C"))
n_taxa_obs_per_area_wallonia_habitat
```

Limited to species from the list of Union concern:

```{r n_taxa_obs_per_area_concern_wallonia_habitat}
n_taxa_obs_per_area_concern_wallonia_habitat <-
  n_taxa_obs_per_area_concern_wallonia %>%
  filter(SITETYPE %in% c("B","C"))
n_taxa_obs_per_area_concern_wallonia_habitat
```

### Brussels

Number of alien taxa and number of observations of alien taxa in each SAC area of Brussels from 2000 up to now:

```{r n_taxa_obs_per_area_brussels_habitat}
n_taxa_obs_per_area_brussels_habitat <-
  n_taxa_obs_per_area_brussels %>%
  filter(SITETYPE %in% c("B","C"))
n_taxa_obs_per_area_brussels_habitat
```

Limited to species from the list of Union concern:

```{r n_taxa_obs_per_area_concern_brussels_habitat}
n_taxa_obs_per_area_concern_brussels_habitat <-
  n_taxa_obs_per_area_concern_brussels %>%
  filter(SITETYPE %in% c("B","C"))
n_taxa_obs_per_area_concern_brussels_habitat
```

# Spread of alien species in protected areas

Now we reverse the analysis by counting in how many protected areas each alien species has been found. If the species is present in at least 10 areas, we calculate the mean coverage of the protected areas as well. Such coverage is the mean of the coverage calculated for each year and each area.

Again, we select observations from 2000. In this case we limit up to the observations of the last year to avoid underestimation of the mean coverage.

```{r last_year}
begin_year <- 2000
last_year <- lubridate::year(Sys.Date()) - 1
```

We define first a help function:

```{r define_n_areas_mean_coverage}
n_areas_mean_coverage <- function(df) {
  df %>%
    group_by(speciesKey) %>%
    summarize(n_prot_areas = length(unique(SITECODE)),
              mean_coverage = if_else(length(unique(SITECODE)) >= 10,
                                      mean(coverage, na.rm = TRUE),
                                      NA_real_)) %>%
    ungroup() %>%
    left_join(taxonomic_metadata, by = "speciesKey")  %>%
    arrange(desc(n_prot_areas),
            desc(mean_coverage),
            scientificName) %>%
    select(scientificName,
           n_prot_areas,
           mean_coverage,
           speciesKey,
           everything())
}
```

## Natura2000 areas

We start by taking into account all type of areas.

### Belgium

Number of protected areas and their mean coverage for each alien species:

```{r n_prot_areas_per_species}
n_prot_areas_per_species <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_concern}
n_prot_areas_per_species_concern <-
  n_prot_areas_per_species %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_concern
```

We proceed now by analyzing the spreading of alien species at regional level.

### Flanders

Number of Flemish protected areas and their mean coverage for each alien species:

```{r n_prot_areas_per_species_flanders}
n_prot_areas_per_species_flanders <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year,
         flanders == TRUE) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species_flanders
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_flanders_concern}
n_prot_areas_per_species_flanders_concern <-
  n_prot_areas_per_species_flanders %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_flanders_concern
```

### Wallonia

Number of protected areas in Wallonia and their mean coverage for each alien species:

```{r n_prot_areas_per_species_wallonia}
n_prot_areas_per_species_wallonia <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year,
         wallonia == TRUE) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species_wallonia
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_wallonia_concern}
n_prot_areas_per_species_wallonia_concern <-
  n_prot_areas_per_species_wallonia %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_wallonia_concern
```

### Wallonia

Number of protected areas of Brussels and their mean coverage for each alien species:

```{r n_prot_areas_per_species_brussels}
n_prot_areas_per_species_brussels <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year,
         brussels == TRUE) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species_wallonia
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_brussels_concern}
n_prot_areas_per_species_brussels_concern <-
  n_prot_areas_per_species_brussels %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_brussels_concern
```

## Bird directive areas

We show the results for the bird directive areas (SPA areas), i.e. areas of `SITETYPE` value `A` or `C`.

### Belgium

Number of SPA protected areas and their mean coverage for each alien species:

```{r n_prot_areas_per_species_bird}
n_prot_areas_per_species_bird <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year,
         SITETYPE %in% c("A", "C")) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species_bird
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_concern_bird}
n_prot_areas_per_species_concern_bird <-
  n_prot_areas_per_species_bird %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_concern_bird
```

We proceed now by analyzing the spreading of alien species at regional level.

### Flanders

Number of Flemish SPA protected areas and their mean coverage for each alien species:

```{r n_prot_areas_per_species_flanders_bird}
n_prot_areas_per_species_flanders_bird <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year,
         SITETYPE %in% c("A", "C"),
         flanders == TRUE) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species_flanders_bird
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_concern_flanders_bird}
n_prot_areas_per_species_concern_flanders_bird <-
  n_prot_areas_per_species_flanders_bird %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_concern_flanders_bird
```

### Wallonia

Number of SPA protected areas in Wallonia and their mean coverage for each alien species:

```{r n_prot_areas_per_species_wallonia_bird}
n_prot_areas_per_species_wallonia_bird <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year,
         SITETYPE %in% c("A", "C"),
         wallonia == TRUE) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species_wallonia_bird
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_concern_wallonia_bird}
n_prot_areas_per_species_concern_wallonia_bird <-
  n_prot_areas_per_species_wallonia_bird %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_concern_wallonia_bird
```

### Brussels

Number of SPA protected areas in Brussels and their mean coverage for each alien species:

```{r n_prot_areas_per_species_Brussels_bird}
n_prot_areas_per_species_brussels_bird <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year,
         SITETYPE %in% c("A", "C"),
         brussels == TRUE) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species_brussels_bird
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_concern_brussels_bird}
n_prot_areas_per_species_concern_brussels_bird <-
  n_prot_areas_per_species_brussels_bird %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_concern_brussels_bird
```

## Habitat directive areas

We show the results for the habitat directive areas (SAC areas), i.e. areas of `SITETYPE` value `B` or `C`.

### Belgium

Number of SAC protected areas and their mean coverage for each alien species:

```{r n_prot_areas_per_species_habitat}
n_prot_areas_per_species_habitat <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year,
         SITETYPE %in% c("B", "C")) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species_habitat
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_concern_habitat}
n_prot_areas_per_species_concern_habitat <-
  n_prot_areas_per_species_habitat %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_concern_habitat
```

We proceed now by analyzing the spreading of alien species at regional level.

### Flanders

Number of Flemish SAC protected areas and their mean coverage for each alien species:

```{r n_prot_areas_per_species_flanders_habitat}
n_prot_areas_per_species_flanders_habitat <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year,
         SITETYPE %in% c("B", "C"),
         flanders == TRUE) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species_flanders_habitat
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_concern_flanders_habitat}
n_prot_areas_per_species_concern_flanders_habitat <-
  n_prot_areas_per_species_flanders_habitat %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_concern_flanders_habitat
```

### Wallonia

Number of SAC protected areas in Wallonia and their mean coverage for each alien species:

```{r n_prot_areas_per_species_wallonia_habitat}
n_prot_areas_per_species_wallonia_habitat <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year,
         SITETYPE %in% c("B", "C"),
         wallonia == TRUE) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species_wallonia_habitat
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_concern_wallonia_habitat}
n_prot_areas_per_species_concern_wallonia_habitat <-
  n_prot_areas_per_species_wallonia_habitat %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_concern_wallonia_habitat
```

### Brussels

Number of SAC protected areas in Brussels and their mean coverage for each alien species:

```{r n_prot_areas_per_species_Brussels_habitat}
n_prot_areas_per_species_brussels_habitat <-
  occs_prot_areas %>%
  left_join(protected_areas_metadata,
            by = c("SITECODE", "SITETYPE")) %>%
  filter(is_alien == TRUE,
         year >= begin_year,
         year <= last_year,
         SITETYPE %in% c("B", "C"),
         brussels == TRUE) %>%
  n_areas_mean_coverage()
n_prot_areas_per_species_brussels_habitat
```

Limited to species included in the list of invasive alien species of Union concern:

```{r n_prot_areas_per_species_concern_brussels_habitat}
n_prot_areas_per_species_concern_brussels_habitat <-
  n_prot_areas_per_species_brussels_habitat %>%
  filter(speciesKey %in% eu_concern_species$backbone_taxonKey)
n_prot_areas_per_species_concern_brussels_habitat
```

# Save data

## Save state of invasion data

We save the analysis of the state of the invasion of the protected areas at national level as retrieving analysis at regional level and for bird or habitat directive areas is trivial:

```{r save_state_of_invasion_data}
n_taxa_obs_per_area_dfs <- list(
  n_taxa_obs_per_area = n_taxa_obs_per_area,
  n_taxa_obs_per_area_concern = n_taxa_obs_per_area_concern
)
map2(n_taxa_obs_per_area_dfs,
     names(n_taxa_obs_per_area_dfs),
     function(df, filename) {
       write_csv(df,
                 here::here("data",
                            "output",
                            "protected_areas_analysis",
                            paste0(filename, ".csv")),
                 na = "")
     })
```

## Save spreading data

We save the analysis of the spreading of alien taxa over protected areas. As the mean coverage depends on the number of protected areas, we save all subsets apart:

```{r save_spreading_data}
n_prot_areas_per_species_dfs <-
  list(
    # Belgium
    n_prot_areas_per_species = n_prot_areas_per_species,
    n_prot_areas_per_species_concern = n_prot_areas_per_species_concern,
    n_prot_areas_per_species_bird = n_prot_areas_per_species_bird,
    n_prot_areas_per_species_concern_bird = 
      n_prot_areas_per_species_concern_bird,
    n_prot_areas_per_species_habitat = n_prot_areas_per_species_habitat,
    n_prot_areas_per_species_concern_habitat = 
      n_prot_areas_per_species_concern_habitat,
    # Flanders
    n_prot_areas_per_species_flanders = n_prot_areas_per_species_flanders,
    n_prot_areas_per_species_flanders_concern = 
      n_prot_areas_per_species_flanders_concern,
    n_prot_areas_per_species_flanders_bird = 
      n_prot_areas_per_species_flanders_bird,
    n_prot_areas_per_species_concern_flanders_bird = 
      n_prot_areas_per_species_concern_flanders_bird,
    n_prot_areas_per_species_flanders_habitat = 
      n_prot_areas_per_species_flanders_habitat,
    n_prot_areas_per_species_concern_flanders_habitat = 
      n_prot_areas_per_species_concern_flanders_habitat,
    # Wallonia
    n_prot_areas_per_species_wallonia = n_prot_areas_per_species_wallonia,
    n_prot_areas_per_species_wallonia_concern = 
      n_prot_areas_per_species_wallonia_concern,
    n_prot_areas_per_species_wallonia_bird = 
      n_prot_areas_per_species_wallonia_bird,
    n_prot_areas_per_species_concern_wallonia_bird = 
      n_prot_areas_per_species_concern_wallonia_bird,
    n_prot_areas_per_species_wallonia_habitat = 
      n_prot_areas_per_species_wallonia_habitat,
    n_prot_areas_per_species_concern_wallonia_habitat = 
      n_prot_areas_per_species_concern_wallonia_habitat,
    # Brussels
    n_prot_areas_per_species_brussels = n_prot_areas_per_species_brussels,
    n_prot_areas_per_species_brussels_concern = 
      n_prot_areas_per_species_brussels_concern,
    n_prot_areas_per_species_brussels_bird = 
      n_prot_areas_per_species_brussels_bird,
    n_prot_areas_per_species_concern_brussels_bird = 
      n_prot_areas_per_species_concern_brussels_bird,
    n_prot_areas_per_species_brussels_habitat = 
      n_prot_areas_per_species_brussels_habitat,
    n_prot_areas_per_species_concern_brussels_habitat = 
      n_prot_areas_per_species_concern_brussels_habitat
  )
# Save data
map2(n_prot_areas_per_species_dfs,
     names(n_prot_areas_per_species_dfs),
     function(df, filename) {
       write_csv(df,
                 here::here("data",
                            "output",
                            "protected_areas_analysis",
                            paste0(filename, ".csv")),
                 na = "")
     })
```
